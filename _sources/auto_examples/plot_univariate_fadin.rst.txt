
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_univariate_fadin.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_univariate_fadin.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_univariate_fadin.py:


==============================================
FaDIn on simulated univariate Hawkes processes
==============================================

This example demonstrates inference performed
by FaDIn on univariate Hawkes processes simulated
with specific kernels.

.. GENERATED FROM PYTHON SOURCE LINES 10-17

.. code-block:: default


    # Authors: Guillaume Staerman <guillaume.staerman@inria.fr>
    #          Alexandre Gramfort <alexandre.gramfort@inria.fr>
    #          Thomas Moreau <thomas.moreau@inria.fr>
    #
    # License: MIT








.. GENERATED FROM PYTHON SOURCE LINES 18-19

Let us first define the parameters of our model.

.. GENERATED FROM PYTHON SOURCE LINES 19-36

.. code-block:: default


    import numpy as np
    import torch
    import matplotlib.pyplot as plt

    from fadin.utils.utils_simu import simu_hawkes_cluster
    from fadin.solver import FaDIn
    from fadin.kernels import DiscreteKernelFiniteSupport

    n_dim = 1
    dt = 0.01
    T = 10_000
    kernel_length = 5
    L = int(1 / dt)
    size_grid = int(T / dt) + 1
    discretization = torch.linspace(0, kernel_length, L)








.. GENERATED FROM PYTHON SOURCE LINES 37-38

Here, we set the parameters of a Hawkes process with an Exponential(1) distribution.

.. GENERATED FROM PYTHON SOURCE LINES 38-42

.. code-block:: default


    baseline = np.array([.4])
    alpha = np.array([[0.8]])








.. GENERATED FROM PYTHON SOURCE LINES 43-44

Here, we simulate the data.

.. GENERATED FROM PYTHON SOURCE LINES 44-51

.. code-block:: default


    # standard parameter is beta, the parameter of the exponential distribution,
    # equal to one.
    kernel = 'expon'

    events = simu_hawkes_cluster(T, baseline, alpha, kernel)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Simulate generation 0
    Simulate generation 1
    Simulate generation 2
    Simulate generation 3
    Simulate generation 4
    Simulate generation 5
    Simulate generation 6
    Simulate generation 7
    Simulate generation 8
    Simulate generation 9
    Simulate generation 10
    Simulate generation 11
    Simulate generation 12
    Simulate generation 13
    Simulate generation 14
    Simulate generation 15
    Simulate generation 16
    Simulate generation 17
    Simulate generation 18
    Simulate generation 19
    Simulate generation 20
    Simulate generation 21
    Simulate generation 22
    Simulate generation 23
    Simulate generation 24
    Simulate generation 25
    Simulate generation 26
    Simulate generation 27
    Simulate generation 28
    Simulate generation 29
    Simulate generation 30
    Simulate generation 31
    Simulate generation 32
    Simulate generation 33
    Simulate generation 34
    Simulate generation 35
    Simulate generation 36
    Simulate generation 37
    Simulate generation 38
    Simulate generation 39
    Simulate generation 40




.. GENERATED FROM PYTHON SOURCE LINES 52-53

Here, we apply FaDIn.

.. GENERATED FROM PYTHON SOURCE LINES 53-74

.. code-block:: default


    solver = FaDIn(n_dim=1,
                   kernel="truncated_exponential",
                   kernel_length=kernel_length,
                   delta=dt, optim="RMSprop",
                   params_optim={'lr': 1e-3},
                   max_iter=2000, criterion='l2'
                   )
    solver.fit(events, T)

    # We average on the 10 last values of the optimization.

    estimated_baseline = solver.param_baseline[-10:].mean().item()
    estimated_alpha = solver.param_alpha[-10:].mean().item()
    param_kernel = [solver.param_kernel[0][-10:].mean().item()]

    print('Estimated baseline is:', estimated_baseline)
    print('Estimated alpha is:', estimated_alpha)
    print('Estimated beta parameter of the exponential kernel is:', param_kernel[0])






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    number of events is: 19123
    precomput: 2.311472177505493
    Fitting model...   0.0%    Fitting model...   0.1%    Fitting model...   0.1%    Fitting model...   0.1%    Fitting model...   0.2%    Fitting model...   0.2%    Fitting model...   0.3%    Fitting model...   0.4%    Fitting model...   0.4%    Fitting model...   0.4%    Fitting model...   0.5%    Fitting model...   0.5%    Fitting model...   0.6%    Fitting model...   0.7%    Fitting model...   0.7%    Fitting model...   0.8%    Fitting model...   0.8%    Fitting model...   0.9%    Fitting model...   0.9%    Fitting model...   0.9%    Fitting model...   1.0%    Fitting model...   1.1%    Fitting model...   1.1%    Fitting model...   1.1%    Fitting model...   1.2%    Fitting model...   1.2%    Fitting model...   1.3%    Fitting model...   1.4%    Fitting model...   1.4%    Fitting model...   1.5%    Fitting model...   1.5%    Fitting model...   1.6%    Fitting model...   1.6%    Fitting model...   1.7%    Fitting model...   1.7%    Fitting model...   1.8%    Fitting model...   1.8%    Fitting model...   1.8%    Fitting model...   1.9%    Fitting model...   1.9%    Fitting model...   2.0%    Fitting model...   2.1%    Fitting model...   2.1%    Fitting model...   2.1%    Fitting model...   2.2%    Fitting model...   2.2%    Fitting model...   2.3%    Fitting model...   2.4%    Fitting model...   2.4%    Fitting model...   2.5%    Fitting model...   2.5%    Fitting model...   2.5%    Fitting model...   2.6%    Fitting model...   2.6%    Fitting model...   2.7%    Fitting model...   2.8%    Fitting model...   2.8%    Fitting model...   2.9%    Fitting model...   2.9%    Fitting model...   2.9%    Fitting model...   3.0%    Fitting model...   3.0%    Fitting model...   3.1%    Fitting model...   3.1%    Fitting model...   3.2%    Fitting model...   3.2%    Fitting model...   3.3%    Fitting model...   3.4%    Fitting model...   3.4%    Fitting model...   3.5%    Fitting model...   3.5%    Fitting model...   3.5%    Fitting model...   3.6%    Fitting model...   3.6%    Fitting model...   3.7%    Fitting model...   3.8%    Fitting model...   3.8%    Fitting model...   3.9%    Fitting model...   3.9%    Fitting model...   4.0%    Fitting model...   4.0%    Fitting model...   4.0%    Fitting model...   4.1%    Fitting model...   4.2%    Fitting model...   4.2%    Fitting model...   4.2%    Fitting model...   4.3%    Fitting model...   4.3%    Fitting model...   4.4%    Fitting model...   4.5%    Fitting model...   4.5%    Fitting model...   4.5%    Fitting model...   4.6%    Fitting model...   4.7%    Fitting model...   4.7%    Fitting model...   4.8%    Fitting model...   4.8%    Fitting model...   4.9%    Fitting model...   4.9%    Fitting model...   5.0%    Fitting model...   5.0%    Fitting model...   5.1%    Fitting model...   5.1%    Fitting model...   5.1%    Fitting model...   5.2%    Fitting model...   5.2%    Fitting model...   5.3%    Fitting model...   5.3%    Fitting model...   5.4%    Fitting model...   5.5%    Fitting model...   5.5%    Fitting model...   5.5%    Fitting model...   5.6%    Fitting model...   5.7%    Fitting model...   5.7%    Fitting model...   5.8%    Fitting model...   5.8%    Fitting model...   5.9%    Fitting model...   5.9%    Fitting model...   5.9%    Fitting model...   6.0%    Fitting model...   6.0%    Fitting model...   6.1%    Fitting model...   6.2%    Fitting model...   6.2%    Fitting model...   6.2%    Fitting model...   6.3%    Fitting model...   6.3%    Fitting model...   6.4%    Fitting model...   6.5%    Fitting model...   6.5%    Fitting model...   6.6%    Fitting model...   6.6%    Fitting model...   6.7%    Fitting model...   6.7%    Fitting model...   6.8%    Fitting model...   6.8%    Fitting model...   6.9%    Fitting model...   6.9%    Fitting model...   7.0%    Fitting model...   7.0%    Fitting model...   7.0%    Fitting model...   7.1%    Fitting model...   7.1%    Fitting model...   7.2%    Fitting model...   7.2%    Fitting model...   7.3%    Fitting model...   7.3%    Fitting model...   7.4%    Fitting model...   7.4%    Fitting model...   7.5%    Fitting model...   7.5%    Fitting model...   7.6%    Fitting model...   7.6%    Fitting model...   7.7%    Fitting model...   7.8%    Fitting model...   7.8%    Fitting model...   7.8%    Fitting model...   7.9%    Fitting model...   8.0%    Fitting model...   8.0%    Fitting model...   8.1%    Fitting model...   8.1%    Fitting model...   8.2%    Fitting model...   8.2%    Fitting model...   8.2%    Fitting model...   8.3%    Fitting model...   8.3%    Fitting model...   8.4%    Fitting model...   8.5%    Fitting model...   8.5%    Fitting model...   8.6%    Fitting model...   8.6%    Fitting model...   8.6%    Fitting model...   8.7%    Fitting model...   8.8%    Fitting model...   8.8%    Fitting model...   8.8%    Fitting model...   8.9%    Fitting model...   8.9%    Fitting model...   9.0%    Fitting model...   9.0%    Fitting model...   9.1%    Fitting model...   9.2%    Fitting model...   9.2%    Fitting model...   9.2%    Fitting model...   9.3%    Fitting model...   9.3%    Fitting model...   9.4%    Fitting model...   9.4%    Fitting model...   9.5%    Fitting model...   9.6%    Fitting model...   9.6%    Fitting model...   9.7%    Fitting model...   9.7%    Fitting model...   9.8%    Fitting model...   9.8%    Fitting model...   9.8%    Fitting model...   9.9%    Fitting model...  10.0%    Fitting model...  10.0%    Fitting model...  10.1%    Fitting model...  10.1%    Fitting model...  10.2%    Fitting model...  10.2%    Fitting model...  10.2%    Fitting model...  10.3%    Fitting model...  10.3%    Fitting model...  10.4%    Fitting model...  10.4%    Fitting model...  10.5%    Fitting model...  10.5%    Fitting model...  10.6%    Fitting model...  10.7%    Fitting model...  10.7%    Fitting model...  10.8%    Fitting model...  10.8%    Fitting model...  10.8%    Fitting model...  10.9%    Fitting model...  10.9%    Fitting model...  11.0%    Fitting model...  11.1%    Fitting model...  11.1%    Fitting model...  11.2%    Fitting model...  11.2%    Fitting model...  11.2%    Fitting model...  11.3%    Fitting model...  11.3%    Fitting model...  11.4%    Fitting model...  11.5%    Fitting model...  11.5%    Fitting model...  11.6%    Fitting model...  11.6%    Fitting model...  11.7%    Fitting model...  11.7%    Fitting model...  11.8%    Fitting model...  11.8%    Fitting model...  11.8%    Fitting model...  11.9%    Fitting model...  11.9%    Fitting model...  12.0%    Fitting model...  12.0%    Fitting model...  12.1%    Fitting model...  12.2%    Fitting model...  12.2%    Fitting model...  12.2%    Fitting model...  12.3%    Fitting model...  12.3%    Fitting model...  12.4%    Fitting model...  12.4%    Fitting model...  12.5%    Fitting model...  12.6%    Fitting model...  12.6%    Fitting model...  12.7%    Fitting model...  12.7%    Fitting model...  12.8%    Fitting model...  12.8%    Fitting model...  12.8%    Fitting model...  12.9%    Fitting model...  13.0%    Fitting model...  13.0%    Fitting model...  13.1%    Fitting model...  13.1%    Fitting model...  13.2%    Fitting model...  13.2%    Fitting model...  13.2%    Fitting model...  13.3%    Fitting model...  13.4%    Fitting model...  13.4%    Fitting model...  13.5%    Fitting model...  13.5%    Fitting model...  13.6%    Fitting model...  13.6%    Fitting model...  13.7%    Fitting model...  13.7%    Fitting model...  13.8%    Fitting model...  13.8%    Fitting model...  13.9%    Fitting model...  13.9%    Fitting model...  14.0%    Fitting model...  14.0%    Fitting model...  14.1%    Fitting model...  14.1%    Fitting model...  14.1%    Fitting model...  14.2%    Fitting model...  14.2%    Fitting model...  14.3%    Fitting model...  14.3%    Fitting model...  14.4%    Fitting model...  14.4%    Fitting model...  14.5%    Fitting model...  14.5%    Fitting model...  14.6%    Fitting model...  14.6%    Fitting model...  14.7%    Fitting model...  14.8%    Fitting model...  14.8%    Fitting model...  14.8%    Fitting model...  14.9%    Fitting model...  14.9%    Fitting model...  15.0%    Fitting model...  15.0%    Fitting model...  15.1%    Fitting model...  15.2%    Fitting model...  15.2%    Fitting model...  15.2%    Fitting model...  15.3%    Fitting model...  15.3%    Fitting model...  15.4%    Fitting model...  15.4%    Fitting model...  15.5%    Fitting model...  15.6%    Fitting model...  15.6%    Fitting model...  15.7%    Fitting model...  15.7%    Fitting model...  15.8%    Fitting model...  15.8%    Fitting model...  15.8%    Fitting model...  15.9%    Fitting model...  16.0%    Fitting model...  16.0%    Fitting model...  16.1%    Fitting model...  16.1%    Fitting model...  16.2%    Fitting model...  16.2%    Fitting model...  16.2%    Fitting model...  16.3%    Fitting model...  16.4%    Fitting model...  16.4%    Fitting model...  16.4%    Fitting model...  16.5%    Fitting model...  16.6%    Fitting model...  16.6%    Fitting model...  16.7%    Fitting model...  16.7%    Fitting model...  16.8%    Fitting model...  16.8%    Fitting model...  16.9%    Fitting model...  16.9%    Fitting model...  17.0%    Fitting model...  17.0%    Fitting model...  17.1%    Fitting model...  17.1%    Fitting model...  17.2%    Fitting model...  17.2%    Fitting model...  17.2%    Fitting model...  17.3%    Fitting model...  17.3%    Fitting model...  17.4%    Fitting model...  17.4%    Fitting model...  17.5%    Fitting model...  17.5%    Fitting model...  17.6%    Fitting model...  17.6%    Fitting model...  17.7%    Fitting model...  17.8%    Fitting model...  17.8%    Fitting model...  17.8%    Fitting model...  17.9%    Fitting model...  17.9%    Fitting model...  18.0%    Fitting model...  18.1%    Fitting model...  18.1%    Fitting model...  18.1%    Fitting model...  18.2%    Fitting model...  18.2%    Fitting model...  18.3%    Fitting model...  18.4%    Fitting model...  18.4%    Fitting model...  18.4%    Fitting model...  18.5%    Fitting model...  18.6%    Fitting model...  18.6%    Fitting model...  18.6%    Fitting model...  18.7%    Fitting model...  18.8%    Fitting model...  18.8%    Fitting model...  18.9%    Fitting model...  18.9%    Fitting model...  18.9%    Fitting model...  19.0%    Fitting model...  19.1%    Fitting model...  19.1%    Fitting model...  19.1%    Fitting model...  19.2%    Fitting model...  19.2%    Fitting model...  19.3%    Fitting model...  19.4%    Fitting model...  19.4%    Fitting model...  19.4%    Fitting model...  19.5%    Fitting model...  19.6%    Fitting model...  19.6%    Fitting model...  19.7%    Fitting model...  19.7%    Fitting model...  19.8%    Fitting model...  19.8%    Fitting model...  19.9%    Fitting model...  19.9%    Fitting model...  20.0%    Fitting model...  20.0%    Fitting model...  20.1%    Fitting model...  20.1%    Fitting model...  20.2%    Fitting model...  20.2%    Fitting model...  20.2%    Fitting model...  20.3%    Fitting model...  20.3%    Fitting model...  20.4%    Fitting model...  20.4%    Fitting model...  20.5%    Fitting model...  20.5%    Fitting model...  20.6%    Fitting model...  20.6%    Fitting model...  20.7%    Fitting model...  20.8%    Fitting model...  20.8%    Fitting model...  20.8%    Fitting model...  20.9%    Fitting model...  20.9%    Fitting model...  21.0%    Fitting model...  21.1%    Fitting model...  21.1%    Fitting model...  21.1%    Fitting model...  21.2%    Fitting model...  21.2%    Fitting model...  21.3%    Fitting model...  21.3%    Fitting model...  21.4%    Fitting model...  21.4%    Fitting model...  21.5%    Fitting model...  21.6%    Fitting model...  21.6%    Fitting model...  21.6%    Fitting model...  21.7%    Fitting model...  21.8%    Fitting model...  21.8%    Fitting model...  21.9%    Fitting model...  21.9%    Fitting model...  21.9%    Fitting model...  22.0%    Fitting model...  22.1%    Fitting model...  22.1%    Fitting model...  22.1%    Fitting model...  22.2%    Fitting model...  22.2%    Fitting model...  22.3%    Fitting model...  22.4%    Fitting model...  22.4%    Fitting model...  22.4%    Fitting model...  22.5%    Fitting model...  22.6%    Fitting model...  22.6%    Fitting model...  22.7%    Fitting model...  22.7%    Fitting model...  22.8%    Fitting model...  22.8%    Fitting model...  22.9%    Fitting model...  22.9%    Fitting model...  22.9%    Fitting model...  23.0%    Fitting model...  23.1%    Fitting model...  23.1%    Fitting model...  23.2%    Fitting model...  23.2%    Fitting model...  23.2%    Fitting model...  23.3%    Fitting model...  23.4%    Fitting model...  23.4%    Fitting model...  23.4%    Fitting model...  23.5%    Fitting model...  23.5%    Fitting model...  23.6%    Fitting model...  23.6%    Fitting model...  23.7%    Fitting model...  23.8%    Fitting model...  23.8%    Fitting model...  23.8%    Fitting model...  23.9%    Fitting model...  23.9%    Fitting model...  24.0%    Fitting model...  24.1%    Fitting model...  24.1%    Fitting model...  24.1%    Fitting model...  24.2%    Fitting model...  24.2%    Fitting model...  24.3%    Fitting model...  24.3%    Fitting model...  24.4%    Fitting model...  24.4%    Fitting model...  24.5%    Fitting model...  24.6%    Fitting model...  24.6%    Fitting model...  24.6%    Fitting model...  24.7%    Fitting model...  24.8%    Fitting model...  24.8%    Fitting model...  24.9%    Fitting model...  24.9%    Fitting model...  24.9%    Fitting model...  25.0%    Fitting model...  25.1%    Fitting model...  25.1%    Fitting model...  25.1%    Fitting model...  25.2%    Fitting model...  25.2%    Fitting model...  25.3%    Fitting model...  25.4%    Fitting model...  25.4%    Fitting model...  25.4%    Fitting model...  25.5%    Fitting model...  25.6%    Fitting model...  25.6%    Fitting model...  25.7%    Fitting model...  25.7%    Fitting model...  25.8%    Fitting model...  25.8%    Fitting model...  25.9%    Fitting model...  25.9%    Fitting model...  25.9%    Fitting model...  26.0%    Fitting model...  26.1%    Fitting model...  26.1%    Fitting model...  26.2%    Fitting model...  26.2%    Fitting model...  26.2%    Fitting model...  26.3%    Fitting model...  26.4%    Fitting model...  26.4%    Fitting model...  26.5%    Fitting model...  26.5%    Fitting model...  26.6%    Fitting model...  26.6%    Fitting model...  26.7%    Fitting model...  26.7%    Fitting model...  26.8%    Fitting model...  26.8%    Fitting model...  26.9%    Fitting model...  26.9%    Fitting model...  27.0%    Fitting model...  27.0%    Fitting model...  27.1%    Fitting model...  27.1%    Fitting model...  27.2%    Fitting model...  27.2%    Fitting model...  27.3%    Fitting model...  27.3%    Fitting model...  27.4%    Fitting model...  27.4%    Fitting model...  27.5%    Fitting model...  27.5%    Fitting model...  27.6%    Fitting model...  27.6%    Fitting model...  27.7%    Fitting model...  27.7%    Fitting model...  27.8%    Fitting model...  27.8%    Fitting model...  27.9%    Fitting model...  27.9%    Fitting model...  28.0%    Fitting model...  28.0%    Fitting model...  28.1%    Fitting model...  28.1%    Fitting model...  28.1%    Fitting model...  28.2%    Fitting model...  28.2%    Fitting model...  28.3%    Fitting model...  28.3%    Fitting model...  28.4%    Fitting model...  28.4%    Fitting model...  28.5%    Fitting model...  28.5%    Fitting model...  28.6%    Fitting model...  28.6%    Fitting model...  28.7%    Fitting model...  28.7%    Fitting model...  28.8%    Fitting model...  28.8%    Fitting model...  28.9%    Fitting model...  28.9%    Fitting model...  29.0%    Fitting model...  29.0%    Fitting model...  29.1%    Fitting model...  29.1%    Fitting model...  29.2%    Fitting model...  29.2%    Fitting model...  29.3%    Fitting model...  29.3%    Fitting model...  29.4%    Fitting model...  29.4%    Fitting model...  29.5%    Fitting model...  29.5%    Fitting model...  29.6%    Fitting model...  29.6%    Fitting model...  29.7%    Fitting model...  29.8%    Fitting model...  29.8%    Fitting model...  29.8%    Fitting model...  29.9%    Fitting model...  29.9%    Fitting model...  30.0%    Fitting model...  30.0%    Fitting model...  30.1%    Fitting model...  30.1%    Fitting model...  30.2%    Fitting model...  30.2%    Fitting model...  30.3%    Fitting model...  30.3%    Fitting model...  30.4%    Fitting model...  30.4%    Fitting model...  30.5%    Fitting model...  30.6%    Fitting model...  30.6%    Fitting model...  30.6%    Fitting model...  30.7%    Fitting model...  30.8%    Fitting model...  30.8%    Fitting model...  30.9%    Fitting model...  30.9%    Fitting model...  30.9%    Fitting model...  31.0%    Fitting model...  31.1%    Fitting model...  31.1%    Fitting model...  31.1%    Fitting model...  31.2%    Fitting model...  31.2%    Fitting model...  31.3%    Fitting model...  31.4%    Fitting model...  31.4%    Fitting model...  31.4%    Fitting model...  31.5%    Fitting model...  31.6%    Fitting model...  31.6%    Fitting model...  31.6%    Fitting model...  31.7%    Fitting model...  31.8%    Fitting model...  31.8%    Fitting model...  31.9%    Fitting model...  31.9%    Fitting model...  31.9%    Fitting model...  32.0%    Fitting model...  32.0%    Fitting model...  32.1%    Fitting model...  32.1%    Fitting model...  32.2%    Fitting model...  32.2%    Fitting model...  32.3%    Fitting model...  32.4%    Fitting model...  32.4%    Fitting model...  32.5%    Fitting model...  32.5%    Fitting model...  32.6%    Fitting model...  32.6%    Fitting model...  32.6%    Fitting model...  32.7%    Fitting model...  32.8%    Fitting model...  32.8%    Fitting model...  32.9%    Fitting model...  32.9%    Fitting model...  33.0%    Fitting model...  33.0%    Fitting model...  33.1%    Fitting model...  33.1%    Fitting model...  33.1%    Fitting model...  33.2%    Fitting model...  33.2%    Fitting model...  33.3%    Fitting model...  33.4%    Fitting model...  33.4%    Fitting model...  33.5%    Fitting model...  33.5%    Fitting model...  33.6%    Fitting model...  33.6%    Fitting model...  33.7%    Fitting model...  33.7%    Fitting model...  33.8%    Fitting model...  33.8%    Fitting model...  33.9%    Fitting model...  33.9%    Fitting model...  34.0%    Fitting model...  34.0%    Fitting model...  34.1%    Fitting model...  34.1%    Fitting model...  34.2%    Fitting model...  34.2%    Fitting model...  34.2%    Fitting model...  34.3%    Fitting model...  34.4%    Fitting model...  34.4%    Fitting model...  34.4%    Fitting model...  34.5%    Fitting model...  34.5%    Fitting model...  34.6%    Fitting model...  34.6%    Fitting model...  34.7%    Fitting model...  34.8%    Fitting model...  34.8%    Fitting model...  34.8%    Fitting model...  34.9%    Fitting model...  34.9%    Fitting model...  35.0%    Fitting model...  35.0%    Fitting model...  35.1%    Fitting model...  35.1%    Fitting model...  35.2%    Fitting model...  35.2%    Fitting model...  35.3%    Fitting model...  35.4%    Fitting model...  35.4%    Fitting model...  35.4%    Fitting model...  35.5%    Fitting model...  35.5%    Fitting model...  35.6%    Fitting model...  35.6%    Fitting model...  35.7%    Fitting model...  35.8%    Fitting model...  35.8%    Fitting model...  35.9%    Fitting model...  35.9%    Fitting model...  35.9%    Fitting model...  36.0%    Fitting model...  36.0%    Fitting model...  36.1%    Fitting model...  36.1%    Fitting model...  36.2%    Fitting model...  36.2%    Fitting model...  36.3%    Fitting model...  36.4%    Fitting model...  36.4%    Fitting model...  36.4%    Fitting model...  36.5%    Fitting model...  36.5%    Fitting model...  36.6%    Fitting model...  36.6%    Fitting model...  36.7%    Fitting model...  36.8%    Fitting model...  36.8%    Fitting model...  36.9%    Fitting model...  36.9%    Fitting model...  37.0%    Fitting model...  37.0%    Fitting model...  37.0%    Fitting model...  37.1%    Fitting model...  37.1%    Fitting model...  37.2%    Fitting model...  37.2%    Fitting model...  37.3%    Fitting model...  37.4%    Fitting model...  37.4%    Fitting model...  37.5%    Fitting model...  37.5%    Fitting model...  37.5%    Fitting model...  37.6%    Fitting model...  37.6%    Fitting model...  37.7%    Fitting model...  37.8%    Fitting model...  37.8%    Fitting model...  37.9%    Fitting model...  37.9%    Fitting model...  38.0%    Fitting model...  38.0%    Fitting model...  38.0%    Fitting model...  38.1%    Fitting model...  38.1%    Fitting model...  38.2%    Fitting model...  38.2%    Fitting model...  38.3%    Fitting model...  38.4%    Fitting model...  38.4%    Fitting model...  38.5%    Fitting model...  38.5%    Fitting model...  38.6%    Fitting model...  38.6%    Fitting model...  38.6%    Fitting model...  38.7%    Fitting model...  38.8%    Fitting model...  38.8%    Fitting model...  38.9%    Fitting model...  38.9%    Fitting model...  39.0%    Fitting model...  39.0%    Fitting model...  39.1%    Fitting model...  39.1%    Fitting model...  39.1%    Fitting model...  39.2%    Fitting model...  39.2%    Fitting model...  39.3%    Fitting model...  39.4%    Fitting model...  39.4%    Fitting model...  39.5%    Fitting model...  39.5%    Fitting model...  39.6%    Fitting model...  39.6%    Fitting model...  39.6%    Fitting model...  39.7%    Fitting model...  39.8%    Fitting model...  39.8%    Fitting model...  39.9%    Fitting model...  39.9%    Fitting model...  40.0%    Fitting model...  40.0%    Fitting model...  40.1%    Fitting model...  40.1%    Fitting model...  40.2%    Fitting model...  40.2%    Fitting model...  40.2%    Fitting model...  40.3%    Fitting model...  40.4%    Fitting model...  40.4%    Fitting model...  40.5%    Fitting model...  40.5%    Fitting model...  40.6%    Fitting model...  40.6%    Fitting model...  40.6%    Fitting model...  40.7%    Fitting model...  40.8%    Fitting model...  40.8%    Fitting model...  40.8%    Fitting model...  40.9%    Fitting model...  40.9%    Fitting model...  41.0%    Fitting model...  41.0%    Fitting model...  41.1%    Fitting model...  41.1%    Fitting model...  41.2%    Fitting model...  41.2%    Fitting model...  41.3%    Fitting model...  41.3%    Fitting model...  41.4%    Fitting model...  41.4%    Fitting model...  41.5%    Fitting model...  41.5%    Fitting model...  41.6%    Fitting model...  41.6%    Fitting model...  41.7%    Fitting model...  41.8%    Fitting model...  41.8%    Fitting model...  41.9%    Fitting model...  41.9%    Fitting model...  41.9%    Fitting model...  42.0%    Fitting model...  42.0%    Fitting model...  42.1%    Fitting model...  42.1%    Fitting model...  42.2%    Fitting model...  42.2%    Fitting model...  42.3%    Fitting model...  42.4%    Fitting model...  42.4%    Fitting model...  42.4%    Fitting model...  42.5%    Fitting model...  42.5%    Fitting model...  42.6%    Fitting model...  42.6%    Fitting model...  42.7%    Fitting model...  42.8%    Fitting model...  42.8%    Fitting model...  42.9%    Fitting model...  42.9%    Fitting model...  43.0%    Fitting model...  43.0%    Fitting model...  43.0%    Fitting model...  43.1%    Fitting model...  43.1%    Fitting model...  43.2%    Fitting model...  43.2%    Fitting model...  43.3%    Fitting model...  43.4%    Fitting model...  43.4%    Fitting model...  43.5%    Fitting model...  43.5%    Fitting model...  43.5%    Fitting model...  43.6%    Fitting model...  43.6%    Fitting model...  43.7%    Fitting model...  43.8%    Fitting model...  43.8%    Fitting model...  43.9%    Fitting model...  43.9%    Fitting model...  44.0%    Fitting model...  44.0%    Fitting model...  44.0%    Fitting model...  44.1%    Fitting model...  44.1%    Fitting model...  44.2%    Fitting model...  44.2%    Fitting model...  44.3%    Fitting model...  44.4%    Fitting model...  44.4%    Fitting model...  44.5%    Fitting model...  44.5%    Fitting model...  44.5%    Fitting model...  44.6%    Fitting model...  44.6%    Fitting model...  44.7%    Fitting model...  44.8%    Fitting model...  44.8%    Fitting model...  44.9%    Fitting model...  44.9%    Fitting model...  45.0%    Fitting model...  45.0%    early stopping at iteration: 900
    iterations in  2.377988576889038
    Estimated baseline is: 0.36326855421066284
    Estimated alpha is: 0.8102593421936035
    Estimated beta parameter of the exponential kernel is: 0.9747012853622437




.. GENERATED FROM PYTHON SOURCE LINES 75-76

Here, we plot the values of the estimated kernel with FaDIn.

.. GENERATED FROM PYTHON SOURCE LINES 76-91

.. code-block:: default


    kernel = DiscreteKernelFiniteSupport(dt, n_dim, kernel='truncated_exponential',
                                         kernel_length=kernel_length)
    kernel_values = kernel.kernel_eval([torch.Tensor([param_kernel])],
                                       discretization)

    plt.plot(discretization[1:], kernel_values.squeeze()[1:]/kernel_length,
             label='FaDIn\' estimated kernel')
    plt.plot(discretization[1:], torch.exp(-discretization[1:]),
             label='True kernel', c='k')
    plt.title('Hawkes influence kernel', size=20)
    plt.xlabel('Time', size=20)
    plt.ylabel(r'$\phi(t)$', size=25)
    plt.legend(fontsize='x-large')
    plt.show()



.. image-sg:: /auto_examples/images/sphx_glr_plot_univariate_fadin_001.png
   :alt: Hawkes influence kernel
   :srcset: /auto_examples/images/sphx_glr_plot_univariate_fadin_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  5.204 seconds)


.. _sphx_glr_download_auto_examples_plot_univariate_fadin.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_univariate_fadin.py <plot_univariate_fadin.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_univariate_fadin.ipynb <plot_univariate_fadin.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
